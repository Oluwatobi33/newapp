<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>News Portal</title>
    <!-- Bootstrap CSS -->
    <link
      rel="stylesheet"
      href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css"
    />
    <!-- FontAwesome for icons -->
    <script
      src="https://kit.fontawesome.com/a076d05399.js"
      crossorigin="anonymous"
    ></script>
    <style>
      body {
        background-color: rgb(240, 240, 240);
      }

      .navbar {
        background-color: #007bff;
      }

      .card {
        box-shadow: 0 4px 8px 0 rgba(0, 0, 0, 0.2);
        transition: 0.3s;
        margin-bottom: 20px;
      }

      .card:hover {
        box-shadow: 0 8px 16px 0 rgba(0, 0, 0, 0.2);
      }

      .news-meta {
        font-size: 12px;
        color: gray;
      }

      .btn-like,
      .btn-dislike {
        cursor: pointer;
      }
    </style>
  </head>

  <body>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark">
      <a class="navbar-brand" href="#">News Portal</a>
      <button
        class="navbar-toggler"
        type="button"
        data-toggle="collapse"
        data-target="#navbarNav"
      >
        <span class="navbar-toggler-icon"></span>
      </button>
      <div class="collapse navbar-collapse" id="navbarNav">
        <ul class="navbar-nav">
          <li class="nav-item active">
            <a class="nav-link" href="#">Home</a>
          </li>
          <li class="nav-item">
            <a class="nav-link" href="#">Latest News</a>
          </li>
          <li class="nav-item dropdown">
            <a
              class="nav-link dropdown-toggle"
              href="#"
              id="navDrop"
              data-toggle="dropdown"
              >Categories</a
            >
            <div class="dropdown-menu">
              <a class="dropdown-item" href="#">Politics</a>
              <a class="dropdown-item" href="#">Sports</a>
              <a class="dropdown-item" href="#">Technology</a>
            </div>
          </li>
        </ul>
      </div>
    </nav>

    <!-- News Section -->
    <div class="container mt-4">
      <h3 class="text-center">Latest News</h3>
      <div id="news-list"></div>
    </div>

    <!-- Bootstrap and jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.bundle.min.js"></script>

    <script>
      function loadAllNews() {
        fetch("/news/all/")
          .then((response) => response.json())
          .then((data) => {
            data.forEach((news) => {
              const newsCard = `
                <div class="card">
                  <img src="${news.image}" class="card-img-top" alt="${
                news.title
              }" />
                  <div class="card-body">
                    <h5 class="card-title">${news.title}</h5>
                    <p class="card-text">${news.text.substring(0, 100)}...</p>
                    <p class="news-meta">
                      <i class="fa fa-eye"></i> ${news.views} Views | 
                      <i class="fa fa-calendar"></i> ${new Date(
                        news.created_at
                      ).toLocaleString()}
                    </p>
                    <button class="btn btn-sm btn-outline-primary" onclick="likeNews(${
                      news.id
                    })">
                      üëç <span id="likes-${news.id}">${news.likes}</span>
                    </button>
                    <button class="btn btn-sm btn-outline-danger" onclick="dislikeNews(${
                      news.id
                    })">
                      üëé <span id="dislikes-${news.id}">${news.dislikes}</span>
                    </button>
                  </div>
                </div>`;
              document.getElementById("news-list").innerHTML += newsCard;
            });
          })
          .catch((error) => console.error("Error loading news:", error));
      }

      // Call function when page loads
      loadAllNews();
    </script>
  </body>
</html>
